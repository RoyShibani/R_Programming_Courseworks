#6)
#a)
# Extract the coefficients from the fitted model
coefficients <- summary(fit)$coefficients
# View the summary of the model
summary(fit)
# Set the working directory:
setwd ("/Users/shibaniroy/Documents/STAT- 6210/HW-2")
dataset <- read.csv ("adult.csv")
#View the structure of the data:
str(dataset)
#View the first few rows of the data:
head(dataset)
#Check the summary statistics:
summary(dataset)
#Check the class of each variable:
sapply(dataset, class)
#2)
# Rename the last column as salary
colnames(dataset)[length(colnames(dataset))] <- "salary"
View(dataset)
#3)
# Remove leading spaces from the values in the salary column
dataset$salary <- trimws(dataset$salary)
# Replace ">50K" with 1 and "<=50K" with 0
dataset$salary <- ifelse(dataset$salary == ">50K", 1, 0)
# Convert salary to a factor with two levels
dataset$salary <- factor(dataset$salary, levels = c(0, 1), labels = c("<=50K", ">50K"))
#5)
# Fit the logistic regression model
fit <- glm(salary ~ ., data = dataset, family = binomial)
# View the summary of the model
summary(fit)
#6)
#a)
# Extract the coefficients from the fitted model
coefficients <- summary(fit)$coefficients
# Get the names of the variables (row names of the coefficients)
variable_names <- rownames(coefficients)
# Create a matrix with just the variable names
result_matrix <- matrix(variable_names, ncol = 1)
# Set the column name for clarity
colnames(result_matrix) <- "Variable"
# Display the result
print(result_matrix)
#b)
# Get the coefficient values (first column)
coefficient_values <- coefficients[, 1]
# Create a matrix with variable names and their coefficients
result_matrix <- cbind(variable_names, coefficient_values)
# Set the column names for clarity
colnames(result_matrix) <- c("Variable", "Coefficient")
# Display the result
print(result_matrix)
#c)
# Create a logical vector for positive coefficients
positive_coefficients <- coefficient_values > 0
# Create a matrix with variable names, coefficients, and positive indicators
result_matrix <- cbind(variable_names, coefficient_values, positive_coefficients)
# Set the column names for clarity
colnames(result_matrix) <- c("Variable", "Coefficient", "Positive")
# Display the result
print(result_matrix)
#d)
# Create a logical vector for positive coefficients
positive_coefficients <- coefficient_values > 0
# Get the p-values (fourth column)
p_values <- coefficients[, 4]
# Create a matrix with variable names, coefficients, positive indicators, and p-values
result_matrix <- cbind(variable_names, coefficient_values, positive_coefficients, p_values)
# Set the column names for clarity
colnames(result_matrix) <- c("Variable", "Coefficient", "Positive", "P-value")
# Display the result
print(result_matrix)
#d)
# Create a logical vector for positive coefficients
positive_coefficients <- coefficient_values > 0
# Get the p-values (fourth column)
p_values <- coefficients[, 4]
# Create a matrix with variable names, coefficients, positive indicators, and p-values
result_matrix <- cbind(variable_names, coefficient_values, positive_coefficients, p_values)
# Set the column names for clarity
colnames(result_matrix) <- c("Variable", "Coefficient", "Positive", "P-value")
# Display the result
print(result_matrix)
# Subset the matrix for p-values < 0.05
significant_vars <- result_matrix[result_matrix[, "P-value"] < 0.05, ]
# Display the significant variables
print(significant_vars)
